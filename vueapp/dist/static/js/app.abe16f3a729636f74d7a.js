webpackJsonp([1],{"0d5x":function(t,e){},"4bxL":function(t,e){},AzAs:function(t,e){},NHnr:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=r("7+uW"),s={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"app"}},[e("router-view")],1)},staticRenderFns:[]};var n=r("VU/8")({name:"App"},s,!1,function(t){r("mmCb")},null,null).exports,a=r("/ocq"),o={name:"Stripe",props:{isSubmitting:Boolean},data:function(){return{card:null,error:"",stripe:null}},methods:{submit:function(){var t=this;this.error="",this.stripe.createToken(this.card).then(function(e){e.error?(t.error=e.error.message,t.$emit("cancel-submit")):t.$emit("set-stripe-token",e.token)})}},mounted:function(){var t=this;this.stripe=Stripe("pk_test_SJaYyjJ2DRXChbLqHGD6YYA6");var e=this.stripe.elements();this.card=e.create("card",{style:{base:{fontSize:"16px",color:"#32325d"}}}),this.card.mount("#card-element"),this.card.addEventListener("change",function(e){t.error=e.error?e.error.message:""})},watch:{isSubmitting:function(t){t&&this.submit()}}},c={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("div",{staticClass:"card-element",attrs:{id:"card-element"}}),this._v(" "),this.error?e("div",{staticClass:"error"},[this._v("\n    "+this._s(this.error)+"\n  ")]):this._e()])},staticRenderFns:[]};var d=r("VU/8")(o,c,!1,function(t){r("bf8T")},null,null).exports,u={name:"TextInput",props:{error:String,forceShowError:Boolean,label:String,val:String},data:function(){return{hasHadFocus:!1}},computed:{showError:function(){return this.error&&(this.forceShowError||this.hasHadFocus)}},methods:{setHasHadFocus:function(t){this.hasHadFocus=!0}}},l={render:function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("label",[t._v(t._s(t.label))]),t._v(" "),r("input",{attrs:{type:"text"},domProps:{value:t.val},on:{input:function(e){t.$emit("update:val",e.target.value)},blur:t.setHasHadFocus}}),t._v(" "),t.showError?r("div",{staticClass:"error"},[t._v("\n    "+t._s(t.error)+"\n  ")]):t._e()])},staticRenderFns:[]},h={name:"CartForm",components:{TextInput:r("VU/8")(u,l,!1,null,null,null).exports},props:{isSubmitting:Boolean,weight:Number},data:function(){return{addressLine1:"",addressLine2:"",city:"",email:"",error:"",firstName:"",hasSubmitted:!1,lastName:"",postalCode:"",province:"",shippingMethod:null,validationsAddressLine1:[{isValid:this.required,message:"You must enter an address."},{isValid:this.lessThan(255),message:"Address is too long."}],validationsAddressLine2:[{isValid:function(t){return!this.val||this.val.length<255},message:"Address line 2 is too long."}],validationsCity:[{isValid:this.required,message:"You must enter a city."},{isValid:this.lessThan(32),message:"City is too long."}],validationsEmail:[{isValid:this.required,message:"You must enter an email address."},{isValid:this.lessThan(255),message:"Email is too long."},{isValid:function(t){return!!t&&t.match(/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/)},message:"Email is not valid."}],validationsFirstName:[{isValid:this.required,message:"You must enter a first name."},{isValid:this.lessThan(32),message:"First name is too long."}],validationsLastName:[{isValid:this.required,message:"You must enter a last name."},{isValid:this.lessThan(32),message:"Last name is too long."}],validationsPostalCode:[{isValid:this.required,message:"You must enter a postal code."},{isValid:function(t){return!!t&&!!t.toUpperCase().match(/^[A-Z]\d[A-Z][ ]*\d[A-Z]\d\s*$/gm)},message:"Postal code is not valid."}]}},computed:{errorAddressLine1:function(){return this.getErrorMessage(this.addressLine1,this.validationsAddressLine1)},errorAddressLine2:function(){return this.getErrorMessage(this.addressLine2,this.validationsAddressLine2)},errorCity:function(){return this.getErrorMessage(this.city,this.validationsCity)},errorEmail:function(){return this.getErrorMessage(this.email,this.validationsEmail)},errorFirstName:function(){return this.getErrorMessage(this.firstName,this.validationsFirstName)},errorLastName:function(){return this.getErrorMessage(this.lastName,this.validationsLastName)},errorPostalCode:function(){return this.getErrorMessage(this.postalCode,this.validationsPostalCode)},errorProvince:function(){return this.showAddressFields&&!this.province&&this.hasSubmitted},errorShippingMethod:function(){if(this.showShippingMethods&&!this.shippingMethod&&this.hasSubmitted)return"A shipping method must be selected."},formData:function(){if(!this.hasErrors){var t={email:this.email,first_name:this.firstName,last_name:this.lastName};return this.showAddressFields?(t.address_line_1=this.addressLine1,t.address_line_2=this.addressLine2,t.city=this.city,t.province=this.province,t.postal_code=this.postalCode):this.showShippingMethods&&(t.pickup_location=this.shippingMethod),t}},hasErrors:function(){var t=!1;return this.showAddressFields&&(t=this.errorAddressLine1||this.errorAddressLine2||this.errorCity||this.errorProvince||this.errorPostalCode),t||this.errorEmail||this.errorFirstName||this.errorLastName||this.errorShippingMethod},isMailSelected:function(){return"mail"===this.shippingMethod},showAddressFields:function(){return this.showShippingMethods&&this.isMailSelected&&this.weight<700},showShippingMethods:function(){return this.weight>0}},methods:{getErrorMessage:function(t,e){var r=e.find(function(e){return!e.isValid(t)});if(r)return r.message},lessThan:function(t){return function(e){return!!e&&e.length<t}},required:function(t){return!!t&&t.length>0},submit:function(){this.hasSubmitted=!0,this.isMailSelected&&!this.showAddressFields?this.$emit("cancel-submit","If you want to order in bulk, you must select a pickup location, or contact us at (EMAIL)."):this.hasErrors?this.$emit("cancel-submit"):this.$emit("set-cart-form-data",this.formData)}},watch:{isSubmitting:function(t){t&&this.submit()}}},v={render:function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("TextInput",{key:"first-name",attrs:{label:"First Name",val:t.firstName,error:t.errorFirstName,forceShowError:t.hasSubmitted},on:{"update:val":function(e){t.firstName=e}}}),t._v(" "),r("TextInput",{key:"last-name",attrs:{label:"Last Name",val:t.lastName,error:t.errorLastName,forceShowError:t.hasSubmitted},on:{"update:val":function(e){t.lastName=e}}}),t._v(" "),r("TextInput",{key:"email",attrs:{label:"Email",val:t.email,error:t.errorEmail,forceShowError:t.hasSubmitted},on:{"update:val":function(e){t.email=e}}}),t._v(" "),r("br"),t._v(" "),t.showShippingMethods?r("div",[t._v("\n    Shipping method:\n    "),r("br"),t._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:t.shippingMethod,expression:"shippingMethod"}],attrs:{type:"radio",id:"input-orangeville",value:"orangeville"},domProps:{checked:t._q(t.shippingMethod,"orangeville")},on:{change:function(e){t.shippingMethod="orangeville"}}}),t._v(" "),r("label",{attrs:{for:"input-orangeville"}},[t._v("\n      Pick up in Orangeville\n    ")]),t._v(" "),r("br"),t._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:t.shippingMethod,expression:"shippingMethod"}],attrs:{type:"radio",id:"input-waterloo",value:"waterloo"},domProps:{checked:t._q(t.shippingMethod,"waterloo")},on:{change:function(e){t.shippingMethod="waterloo"}}}),t._v(" "),r("label",{attrs:{for:"input-waterloo"}},[t._v("\n      Pick up in Waterloo\n    ")]),t._v(" "),r("br"),t._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:t.shippingMethod,expression:"shippingMethod"}],attrs:{type:"radio",id:"input-mail",value:"mail"},domProps:{checked:t._q(t.shippingMethod,"mail")},on:{change:function(e){t.shippingMethod="mail"}}}),t._v(" "),r("label",{attrs:{for:"input-mail"}},[t._v("\n      Mail\n    ")]),t._v(" "),r("br"),t._v(" "),t.errorShippingMethod?r("div",{staticClass:"error"},[t._v("\n      "+t._s(t.errorShippingMethod)+"\n    ")]):t._e(),t._v(" "),r("br")]):t._e(),t._v(" "),t.showAddressFields?r("div",[r("TextInput",{key:"address-line-1",attrs:{label:"Address Line 1",val:t.addressLine1,error:t.errorAddressLine1,forceShowError:t.hasSubmitted},on:{"update:val":function(e){t.addressLine1=e}}}),t._v(" "),r("TextInput",{key:"address-line-2",attrs:{label:"Address Line 2",val:t.addressLine2,error:t.errorAddressLine2,forceShowError:t.hasSubmitted},on:{"update:val":function(e){t.addressLine2=e}}}),t._v(" "),r("TextInput",{key:"city",attrs:{label:"City",val:t.city,error:t.errorCity,forceShowError:t.hasSubmitted},on:{"update:val":function(e){t.city=e}}}),t._v(" "),r("label",{attrs:{for:"input-province"}},[t._v("Province")]),t._v(" "),r("select",{directives:[{name:"model",rawName:"v-model",value:t.province,expression:"province"}],attrs:{id:"input-province"},on:{change:function(e){var r=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.province=e.target.multiple?r:r[0]}}},[r("option",{attrs:{value:""}},[t._v("Select a province")]),t._v(" "),r("option",{attrs:{value:"AB"}},[t._v("AB")]),t._v(" "),r("option",{attrs:{value:"BC"}},[t._v("BC")]),t._v(" "),r("option",{attrs:{value:"MB"}},[t._v("MB")]),t._v(" "),r("option",{attrs:{value:"NB"}},[t._v("NB")]),t._v(" "),r("option",{attrs:{value:"NL"}},[t._v("NL")]),t._v(" "),r("option",{attrs:{value:"NS"}},[t._v("NS")]),t._v(" "),r("option",{attrs:{value:"ON"}},[t._v("ON")]),t._v(" "),r("option",{attrs:{value:"PE"}},[t._v("PE")]),t._v(" "),r("option",{attrs:{value:"QC"}},[t._v("QC")]),t._v(" "),r("option",{attrs:{value:"SK"}},[t._v("SK")]),t._v(" "),r("option",{attrs:{value:"NT"}},[t._v("NT")]),t._v(" "),r("option",{attrs:{value:"NU"}},[t._v("NU")]),t._v(" "),r("option",{attrs:{value:"YT"}},[t._v("YT")])]),t._v(" "),t.errorProvince?r("div",{staticClass:"error"},[t._v("\n      You must select a province.\n    ")]):t._e(),t._v(" "),r("TextInput",{key:"postal-code",attrs:{label:"Postal Code",val:t.postalCode,error:t.errorPostalCode,forceShowError:t.hasSubmitted},on:{"update:val":function(e){t.postalCode=e}}}),t._v(" "),r("br")],1):t.isMailSelected?r("div",[t._v('\n    If you\'d like to order more than four items, you can select a "Pick up" method, or contact us at (EMAIL) if you would like a bulk order shipped to you.\n    '),r("br"),r("br")]):t._e()],1)},staticRenderFns:[]},m=r("VU/8")(h,v,!1,null,null,null).exports,p=r("mtWM"),_={name:"Cart",components:{CartForm:m,Stripe:d},data:function(){return{cartFormData:null,error:"",isSubmitting:!1,submittedSuccessfully:!1,stripeToken:null}},props:{cart:Array},computed:{centsCharged:function(){for(var t=0,e=0;e<this.cart.length;e++)t+=this.cart[e].cents;return t},weight:function(){for(var t=0,e=0;e<this.cart.length;e++)t+=this.cart[e].grams;return t}},methods:{attemptSubmit:function(){this.isSubmitting&&this.stripeToken&&this.cartFormData&&this.submit()},cancelSubmit:function(t){this.isSubmitting=!1,this.stripeToken=null,this.cartFormData=null,this.error=t||""},centsToDollars:function(t){return"$"+(t/100).toFixed(2)},setCartFormData:function(t){this.isSubmitting&&(this.cartFormData=t,this.attemptSubmit())},setStripeToken:function(t){this.isSubmitting&&(this.stripeToken=t,this.attemptSubmit())},submit:function(){var t=this;p.post("https://coz-store.herokuapp.com/api/transactions",{address_line_1:this.cartFormData.address_line_1,address_line_2:this.cartFormData.address_line_2,cart:this.cart,cents_charged_total:this.centsCharged,city:this.cartFormData.city,first_name:this.cartFormData.first_name,last_name:this.cartFormData.last_name,pickup_location:this.cartFormData.pickup_location,postal_code:this.cartFormData.postal_code,province:this.cartFormData.province,stripe_token:this.stripeToken}).then(function(e){t.submittedSuccessfully=!0}).catch(function(e){t.error=e}).finally(function(){t.isSubmitting=!1})},triggerSubmit:function(){this.error="",this.isSubmitting=!0}}},f={render:function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"cart container"},[r("h2",[t._v("Cart")]),t._v(" "),t.cart.length?r("div",[t._l(t.cart,function(e){return r("div",{staticClass:"cart-product"},[r("div",[r("a",{staticClass:"remove",attrs:{tabindex:"0"},on:{click:function(r){t.$emit("remove-from-cart",e)}}},[t._v("\n          (x)\n        ")]),t._v("\n        "+t._s(e.name)+"\n      ")]),t._v(" "),r("div",[t._v("\n        "+t._s(t.centsToDollars(e.cents))+"\n      ")])])}),t._v(" "),r("hr"),t._v(" "),r("div",{staticClass:"total"},[t._v("\n      Total: "+t._s(t.centsToDollars(t.centsCharged))+"\n    ")]),t._v(" "),r("br"),t._v(" "),r("h4",[t._v("Submission Form")]),t._v(" "),r("CartForm",{attrs:{weight:t.weight,isSubmitting:t.isSubmitting},on:{"cancel-submit":t.cancelSubmit,"set-cart-form-data":t.setCartFormData}}),t._v(" "),r("Stripe",{attrs:{isSubmitting:t.isSubmitting},on:{"cancel-submit":t.cancelSubmit,"set-stripe-token":t.setStripeToken}}),t._v(" "),r("br"),t._v(" "),t.error.length?r("div",[r("div",{staticClass:"error"},[t._v("\n        "+t._s(t.error)+"\n      ")]),t._v(" "),r("br")]):t._e(),t._v(" "),t.isSubmitting?r("div",[t._v("\n      Submitting...\n    ")]):t.submittedSuccessfully?r("div",{staticClass:"success"},[t._v("\n      Success!\n    ")]):r("button",{on:{click:function(e){t.triggerSubmit()}}},[t._v("\n      Submit payment\n    ")])],2):r("div",[t._v("\n    Your cart is empty.\n  ")])])},staticRenderFns:[]};var g=r("VU/8")(_,f,!1,function(t){r("lvaT")},"data-v-3852d21d",null).exports,b={name:"Nav",props:{itemsInCart:Number}},S={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"nav"},[e("div",{staticClass:"container"},[e("h3",[this._v("Citizen of Zion Store")]),this._v(" "),e("h3",[this._v("Cart: "+this._s(this.itemsInCart))])])])},staticRenderFns:[]};var C=r("VU/8")(b,S,!1,function(t){r("U33U")},"data-v-c1ceb04a",null).exports,w={name:"Product",props:{product:Object},computed:{cost:function(){return"$"+(this.product.cents/100).toFixed(2)}}},F={render:function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"product"},[r("h4",[t._v(t._s(t.product.name))]),t._v(" "),r("div",[t._v(t._s(t.product.description))]),t._v(" "),r("h4",[t._v(t._s(t.cost))]),t._v(" "),r("button",{on:{click:function(e){t.$emit("add-to-cart")}}},[t._v("\n    Add to cart\n  ")])])},staticRenderFns:[]};var y=r("VU/8")(w,F,!1,function(t){r("0d5x")},"data-v-55fa5f4e",null).exports,M=r("mtWM"),L={name:"ProductList",components:{Product:y},data:function(){return{error:!1,forceShowLoading:!0,loading:!0,products:[]}},computed:{showLoading:function(){return this.forceShowLoading||this.loading}},mounted:function(){var t=this;setTimeout(function(){t.forceShowLoading=!1},1e3),M.get("https://coz-store.herokuapp.com/api/products").then(function(e){t.products=e.data.products}).catch(function(e){t.error=!0}).finally(function(){t.loading=!1})}},N={render:function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"container"},[r("h2",[t._v("Product List")]),t._v(" "),r("div",{staticClass:"product-list-container"},[t.showLoading?r("h3",[t._v("Loading...")]):t._l(t.products,function(e){return r("Product",{key:e.id,attrs:{product:e},on:{"add-to-cart":function(r){t.$emit("add-to-cart",e)}}})})],2)])},staticRenderFns:[]};var E={name:"MainPage",components:{Cart:g,Nav:C,ProductList:r("VU/8")(L,N,!1,function(t){r("AzAs")},"data-v-41f3aeb2",null).exports},data:function(){return{cart:[]}},methods:{addToCart:function(t){this.cart.push(t)},removeFromCart:function(t){this.cart.splice(this.cart.indexOf(t),1)}}},k={render:function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"main"},[r("Nav",{attrs:{itemsInCart:t.cart.length}}),t._v(" "),r("h1",[t._v("Main Page")]),t._v(" "),r("ProductList",{on:{"add-to-cart":t.addToCart}}),t._v(" "),r("Cart",{attrs:{cart:t.cart},on:{"remove-from-cart":t.removeFromCart}})],1)},staticRenderFns:[]};var A=r("VU/8")(E,k,!1,function(t){r("4bxL")},null,null).exports;i.a.use(a.a);var T=new a.a({routes:[{path:"/",name:"MainPage",component:A}]});i.a.config.productionTip=!1,new i.a({el:"#app",router:T,components:{App:n},template:"<App/>"})},U33U:function(t,e){},bf8T:function(t,e){},lvaT:function(t,e){},mmCb:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.abe16f3a729636f74d7a.js.map